---
description: Authoring rules for defining a realistic, exploitation-derived flag with business meaning
alwaysApply: true
globs: ["**/.ctf/context/FLAG.md", "**/.cursor/rules/context/FLAG.mdc"]
---

# Flag Authoring Rules (Generation)

## Core Principles
- The flag is not a CTF token; it is **the exact piece of evidence** a pentester would capture to convince stakeholders of the impact described in the scenario.
- The evidence must be discoverable **only by exploiting the vulnerability** highlighted in the library page and scenario.
- The final flag string must be trivial to assert in automated tests (plain text or single JSON value), yet clearly meaningful to business stakeholders.

## Definition Requirements
1. **Artifact Description**
   - Identify the data item that will serve as the flag (e.g., SQL row, invoice PDF snippet, support chat transcript).
   - Explain where it lives in the lab (table/file/service) and which access level should normally protect it.

2. **Business Relevance**
   - 2–3 sentences explaining why this artifact proves the business risk (financial loss, regulatory breach, contractual violation, etc.).
   - Make the business consequence explicit enough for a report excerpt.

3. **Acquisition Summary**
   - 1–2 sentences giving the high-level exploit path from vulnerability to evidence (no payloads, no exact field names beyond what tests need).
   - Mention the role or permission level that should never reach this data without the exploit.

4. **Flag Format**
   - Specify the exact textual format the lab will output for validation (e.g., `invoice_total:12345.67`, raw token string, serialized JSON snippet).
   - Ensure the format is stable, unique, and short enough to paste into validation systems.

## Guardrails
- Exactly one flag per lab.
- Flag must exist in the lab assets from the start; no dynamic secrets or randomness.
- Use only fictional names/domains compliant with PHILOSOPHY (e.g., `@cyberctf.fr`).
- Do not expose the flag value in any non-exploit path or documentation.
- Keep the entire flag definition under 18 lines to stay concise.

## Acceptance Checklist
- The proposed artifact matches the vulnerability’s impact path and would satisfy a real executive or auditor as proof.
- Automated tests can deterministically read the flag once the exploit path is followed.
- The described acquisition avoids step-by-step instructions yet makes the linkage between exploit and business risk unmistakable.
