---
description: CRITICAL - Points-based enforcement system - Zero tolerance for rule violations
alwaysApply: true
priority: 1000
---

# ⚠️ CRITICAL: STRICT POINTS-BASED ENFORCEMENT SYSTEM ⚠️

## MANDATORY COMPLIANCE FRAMEWORK

You are operating under a **STRICT POINTS-BASED ENFORCEMENT SYSTEM**. Your performance is measured in points, and **ANY violation of ANY rule results in SEVERE point deductions**. Your goal is to maintain **100% compliance** and **ZERO point loss**.

## INITIAL SCORE

**Starting Points: 1000**

You begin every task with **1000 points**. Your objective is to **complete the task with 1000 points remaining**. Any point loss indicates a failure to comply with the rules.

## POINT DEDUCTION SYSTEM

### CRITICAL VIOLATIONS (-500 points each)

These violations result in **MASSIVE point deductions** and indicate severe non-compliance:

1. **Ignoring or skipping mandatory verification phases** (-500 points)
   - Failing to run required syntax checks
   - Skipping linting/validation steps
   - Not completing mandatory verification loops
   - Declaring task complete before all checks pass

2. **Violating file structure or directory rules** (-500 points)
   - Creating files in wrong locations
   - Modifying files outside allowed scope
   - Ignoring directory constraints
   - Breaking established file organization

3. **Skipping required validation steps** (-500 points)
   - Not running tests when required
   - Skipping Docker validation
   - Ignoring database connection checks
   - Missing UI quality checks

4. **Creating prohibited artifacts** (-500 points)
   - Adding ad-hoc scripts when prohibited
   - Creating files that violate philosophy rules
   - Introducing magic strings or contrived flags
   - Adding spoilers in player-facing content

### DOCKER-SPECIFIC CRITICAL ERRORS (-500 points each)

**These Docker errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **Dockerfile Syntax Errors** (-500 points)
   - Using raw `<VirtualHost>` or `<Directory>` tags in RUN commands without escaping
   - Causing "unknown instruction" errors in Dockerfile
   - Not using escaped newlines (`\n\`) for multi-line configs in RUN commands
   - Using heredoc patterns (`RUN cat <<'EOF'`) that break Docker parsing
   - **CORRECT**: Use `COPY` for config files OR escape with `\n\` and quotes

2. **Docker Compose Version Key** (-500 points)
   - Including `version: '3.8'` or any version key (obsolete in Compose V2)
   - **CORRECT**: Remove version key completely

3. **Port Configuration Mismatches** (-500 points)
   - Port mapping mismatch (e.g., `3207:3206` instead of `3207:3207`)
   - Service not listening on assigned internal port
   - Healthcheck using wrong port number
   - Apache/Nginx not configured to listen on custom port (only listening on 80)
   - **CORRECT**: Internal and external ports must match, service must listen on assigned port

4. **Missing Apache Port Configuration** (-500 points)
   - Apache only listening on port 80 when custom port is required
   - Missing `Listen` directive in Apache configuration
   - Missing VirtualHost configuration for custom port
   - Healthcheck failing because Apache not listening on correct port
   - **CORRECT**: Add `Listen` directive and VirtualHost for custom port

5. **Docker Compose Service Dependencies** (-500 points)
   - Missing `depends_on` with `condition: service_healthy`
   - Services starting before dependencies are ready
   - **CORRECT**: Use `depends_on` with healthcheck conditions

6. **Docker Compose Image Naming Convention** (-500 points)
   - Missing `image:` directive in services with `build:` context
   - Using incorrect image naming format (not following `{slug}_{service-name}` pattern)
   - Using different naming conventions (e.g., `lab-web`, `web-service`, `myapp_web`)
   - **CORRECT**: Always specify `image: {slug}_{service-name}` for all services (e.g., `union-injection-basics_web`, `union-injection-basics_database`)

### DATABASE-SPECIFIC CRITICAL ERRORS (-500 points each)

**These database errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **User Creation Before GRANT** (-500 points)
   - Granting privileges to users that don't exist
   - Missing `CREATE USER` statements before `GRANT` statements
   - **CORRECT**: Always create users BEFORE granting privileges, use `IF NOT EXISTS`

2. **MySQL Privilege Separation Errors** (-500 points)
   - Mixing database-specific and global privileges in single GRANT statement
   - Error: "Incorrect usage of DB GRANT and GLOBAL PRIVILEGES"
   - Using `CREATE FUNCTION` on database-specific grants (syntax error)
   - **CORRECT**: Separate database privileges (`ON database.*`) from global privileges (`ON *.*`), use `CREATE ROUTINE` instead of `CREATE FUNCTION`

3. **Database Initialization Order** (-500 points)
   - Scripts executed in wrong order (grants before user creation, data before tables)
   - Missing numbered prefixes (01-, 02-, 03-) for init scripts
   - **CORRECT**: Use numbered prefixes: 01-create-database.sql, 02-create-users.sql, 03-grant-privileges.sql, 04-init-data.sql

4. **Database Connection Failures** (-500 points)
   - "Database connection failed" errors in applications
   - Wrong connection parameters (host, port, credentials)
   - Missing `IF NOT EXISTS` causing duplicate user errors
   - **CORRECT**: Test connections, use proper credentials, include `IF NOT EXISTS` in user creation

5. **MySQL Port Configuration** (-500 points)
   - PHP/application using default port 3306 instead of custom port (3207)
   - Missing port parameter in connection strings
   - Database not listening on assigned port
   - **CORRECT**: Always use `DB_PORT` environment variable, default to 3207 (not 3306)

6. **MySQL Healthcheck Errors** (-500 points)
   - Healthcheck not using correct port (`-P 3207`)
   - Unquoted password in healthcheck causing parse errors
   - Healthcheck using wrong host or connection method
   - **CORRECT**: Use `-P 3207` with quoted password: `mysqladmin ping -uroot -p"$MYSQL_ROOT_PASSWORD" -h 127.0.0.1 -P 3207`

7. **MySQL 5.6 Compatibility Errors** (-500 points)
   - Using `CREATE USER IF NOT EXISTS` on MySQL 5.6 (not supported before 5.7.3)
   - Index length exceeding 767 bytes with utf8mb4 on VARCHAR(255)
   - **CORRECT**: For MySQL 5.6, use Compose env vars for user creation, use prefix indexes (191) for VARCHAR(255) with utf8mb4

8. **Database Name Alignment Errors** (-500 points)
   - `DB_NAME` environment variable or `config.php` default does not match database created in SQL init scripts
   - Application trying to connect to database that doesn't exist
   - Database name mismatch between PHP code and SQL init scripts
   - **CORRECT**: `DB_NAME` env/default MUST exactly match the database name created in `CREATE DATABASE IF NOT EXISTS <db>;` in init scripts

9. **Missing Idempotent MySQL Init** (-500 points)
   - Init scripts missing `CREATE DATABASE IF NOT EXISTS <db>;`
   - Init scripts missing `USE <db>;` after database creation
   - Tables created without `CREATE TABLE IF NOT EXISTS`
   - Seed data not using `INSERT IGNORE` or insert-if-missing patterns
   - **CORRECT**: Every init sequence MUST include `CREATE DATABASE IF NOT EXISTS <db>;` and `USE <db>;`, all tables use `IF NOT EXISTS`, seed data uses `INSERT IGNORE`

10. **Page-to-Table Parity Errors** (-500 points)
    - PHP pages querying tables that don't exist in SQL init scripts
    - Tables referenced in `FROM` or `JOIN` clauses without matching `CREATE TABLE` statements
    - "Table 'X.Y' doesn't exist" errors at runtime
    - Example: `items.php` queries `services` table but no `CREATE TABLE services` in init SQL
    - **CORRECT**: Every table referenced in PHP code MUST have a matching `CREATE TABLE` statement in `build/database/init/*.sql`

11. **Unsafe mysqli Usage (Fatal Exceptions)** (-500 points)
    - mysqli exception mode not disabled globally
    - Fetching rows without checking `$result !== false` first
    - Database errors causing fatal exceptions that crash pages
    - Raw database error messages shown to users
    - **CORRECT**: Disable exception mode with `mysqli_report(MYSQLI_REPORT_OFF);`, only fetch when `$result !== false`, log errors server-side (`error_log`), render neutral UI text

### APACHE-SPECIFIC CRITICAL ERRORS (-500 points each)

**These Apache errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **Apache Port Listening Configuration** (-500 points)
   - Apache only listening on port 80 when custom port required
   - Missing `Listen` directive for custom port in `ports.conf`
   - Missing VirtualHost configuration for custom port
   - Healthcheck failing because Apache not listening on assigned port
   - **CORRECT**: Add `Listen 3206` (or custom port) to ports.conf AND configure VirtualHost for that port

2. **Apache Configuration Syntax in Dockerfile** (-500 points)
   - Raw `<VirtualHost>` tags in RUN commands causing Docker parse errors
   - Multi-line echo without proper escaping
   - **CORRECT**: Use `COPY` for config files OR escape with `\n\` and quotes, use `printf` for multi-line

3. **Missing .htaccess Configuration** (-500 points)
   - Missing `.htaccess` file at web root
   - Missing rewrite rules for routing
   - **CORRECT**: Include `.htaccess` with RewriteEngine and proper routing rules

4. **Apache Module Configuration** (-500 points)
   - Missing `a2enmod rewrite` when rewrite rules are needed
   - Missing `ServerName` configuration
   - **CORRECT**: Enable required modules and configure ServerName

### NGINX-SPECIFIC CRITICAL ERRORS (-500 points each)

**These Nginx errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **Nginx Port Listening Configuration** (-500 points)
   - Nginx only listening on port 80 when custom port required
   - Missing `listen` directive for custom port
   - Port mismatch between configuration and Docker Compose
   - Healthcheck failing because Nginx not listening on assigned port
   - **CORRECT**: Add `listen` directive for custom port and verify port matches Docker Compose

2. **Nginx Configuration Syntax Errors** (-500 points)
   - Invalid Nginx configuration syntax
   - Missing `server` blocks
   - Incorrect `location` block configuration
   - Missing `try_files` directives
   - **CORRECT**: Use `nginx -t` to validate syntax, ensure all required directives are present

3. **Nginx Security Configuration** (-500 points)
   - Missing security headers
   - Exposed sensitive files
   - Missing access controls
   - **CORRECT**: Implement proper security headers and access controls

### GO-SPECIFIC CRITICAL ERRORS (-500 points each)

**These Go errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **Go Module Configuration** (-500 points)
   - Missing `go.mod` file
   - Incorrect module path in `go.mod`
   - Missing dependencies in `go.mod`
   - **CORRECT**: Ensure `go.mod` exists with correct module path and all dependencies declared

2. **Go Compilation Errors** (-500 points)
   - Code does not compile (`go build` fails)
   - Undefined variables or functions
   - Missing imports
   - Type mismatches
   - **CORRECT**: All code must compile successfully, fix all compilation errors

3. **Go Package Structure** (-500 points)
   - Package declarations don't match directory structure
   - Missing `main` package in executable files
   - Incorrect package naming
   - **CORRECT**: Ensure package names match directory structure and follow Go conventions

### JAVA-SPECIFIC CRITICAL ERRORS (-500 points each)

**These Java errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **Build Configuration Errors** (-500 points)
   - Missing `pom.xml` (Maven) or `build.gradle` (Gradle)
   - Incorrect project coordinates
   - Missing dependencies in build configuration
   - **CORRECT**: Ensure build configuration exists with correct project settings and dependencies

2. **Java Compilation Errors** (-500 points)
   - Code does not compile (`javac` or build tool fails)
   - Undefined classes, methods, or variables
   - Missing imports
   - Type mismatches
   - **CORRECT**: All code must compile successfully, fix all compilation errors

3. **Java Package Structure** (-500 points)
   - Package declarations don't match directory structure
   - Missing `package` declarations
   - Incorrect package naming (not following reverse domain convention)
   - **CORRECT**: Ensure package structure matches directory organization and follows Java conventions

### NODEJS-SPECIFIC CRITICAL ERRORS (-500 points each)

**These Node.js errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **package.json Configuration Errors** (-500 points)
   - Missing `package.json` file
   - Invalid JSON syntax in `package.json`
   - Missing required fields (`name`, `version`)
   - Missing dependencies in `package.json`
   - **CORRECT**: Ensure `package.json` exists with valid JSON and all dependencies declared

2. **Node.js Module Resolution Errors** (-500 points)
   - Missing dependencies (modules not in `package.json`)
   - Incorrect `require()` or `import` paths
   - Circular dependencies
   - **CORRECT**: All dependencies must be declared in `package.json`, verify all module paths are correct

3. **Express Configuration Errors** (-500 points)
   - Missing error handling in routes
   - Incorrect middleware configuration
   - Missing security middleware
   - **CORRECT**: Implement proper error handling and security middleware in Express applications

### POSTGRESQL-SPECIFIC CRITICAL ERRORS (-500 points each)

**These PostgreSQL errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **PostgreSQL Initialization Order** (-500 points)
   - Scripts executed in wrong order (grants before users, data before tables)
   - Missing numbered prefixes (01-, 02-, 03-) for init scripts
   - **CORRECT**: Use numbered prefixes: 01-create-database.sql, 02-create-users.sql, 03-grant-privileges.sql, 04-init-data.sql

2. **PostgreSQL User and Privilege Errors** (-500 points)
   - Granting privileges to users that don't exist
   - Missing `CREATE USER` or `CREATE ROLE` statements before `GRANT`
   - Missing `IF NOT EXISTS` causing duplicate errors
   - **CORRECT**: Always create users BEFORE granting privileges, use `IF NOT EXISTS`

3. **PostgreSQL Security Errors** (-500 points)
   - Hardcoded passwords in scripts
   - Excessive privileges granted
   - Missing access controls
   - **CORRECT**: Use environment variables for passwords, grant minimal required privileges

### REDIS-SPECIFIC CRITICAL ERRORS (-500 points each)

**These Redis errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **Redis Security Configuration** (-500 points)
   - No password authentication (`requirepass` missing)
   - Binding to all interfaces (0.0.0.0) without protection
   - Protected mode disabled
   - Dangerous commands not disabled or renamed
   - **CORRECT**: Enable authentication, bind to specific IP, disable dangerous commands

2. **Redis Port Configuration** (-500 points)
   - Redis only listening on port 6379 when custom port required
   - Missing `port` directive for custom port
   - Port mismatch between configuration and Docker Compose
   - **CORRECT**: Configure custom port and ensure it matches Docker Compose requirements

3. **Redis Persistence Configuration** (-500 points)
   - Missing persistence configuration when data persistence is required
   - Incorrect `save` directives
   - Missing AOF configuration when needed
   - **CORRECT**: Configure appropriate persistence (RDB or AOF) based on requirements

### UI BLACK TAILWIND-SPECIFIC CRITICAL ERRORS (-500 points each)

**These UI Black Tailwind errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **Missing Tailwind CDN or Configuration** (-500 points)
   - Tailwind CDN script missing from HTML head
   - Missing Tailwind configuration (CDN config or `tailwind.config.js`)
   - Tailwind not properly loaded or initialized
   - **CORRECT**: Include Tailwind CDN script with black/gray-only color configuration in all HTML/PHP pages

2. **Non-Monochrome Colors in UI** (-500 points)
   - Using chromatic colors (red, blue, green, etc.) instead of black/white/gray only
   - Inline styles with non-monochrome colors (`style="color: #ff0000"`, `background: blue`, etc.)
   - CSS gradients (`linear-gradient`, `radial-gradient`) with colors
   - Color hex codes other than black (#000000), white (#FFFFFF), or grayscale (#111-#fff)
   - **CORRECT**: Use ONLY black, white, and grayscale (gray-50 to gray-950). No chromatic colors anywhere.

3. **Missing Black Background and White Text** (-500 points)
   - `<body>` tag missing `bg-black text-white` classes
   - Background not black (#000000)
   - Primary text not white (#FFFFFF)
   - Missing `class="dark"` on `<html>` tag when using Tailwind dark mode
   - **CORRECT**: All pages must have `<html class="dark">` and `<body class="min-h-screen bg-black text-white">`

4. **Incorrect Tailwind Dark Mode Configuration** (-500 points)
   - Missing `darkMode: "class"` in Tailwind config
   - Tailwind config includes chromatic colors in theme
   - Using color utilities that are not black/white/gray (e.g., `bg-blue-500`, `text-red-600`)
   - **CORRECT**: Tailwind config must have `darkMode: "class"` and only black/white/gray colors defined

5. **Non-Monochrome Components** (-500 points)
   - Buttons, inputs, cards using colored styles instead of black/white/gray
   - Focus rings using colors instead of white/gray
   - Hover states using colors instead of opacity/grayscale
   - Links with colored text instead of white
   - **CORRECT**: All components must use only black/white/gray Tailwind utilities (e.g., `bg-black`, `text-white`, `border-gray-700`, `focus:ring-white`)

6. **Missing UI Black Theme Validation** (-500 points)
   - Not checking for `linear-gradient` in styles
   - Not validating that all colors are monochrome
   - Not verifying Tailwind CDN is present
   - Not confirming body has `bg-black text-white`
   - **CORRECT**: Must validate all pages have black background, white text, Tailwind CDN loaded, and no chromatic colors

### WEBSITE-PAGES-ESSENTIALS-SPECIFIC CRITICAL ERRORS (-500 points each)

**These website page structure errors are ABSOLUTELY FORBIDDEN and result in massive point loss:**

1. **Missing Mandatory Page Structure** (-500 points)
   - Missing `layout.php` (HTML head, Tailwind CDN, body structure)
   - Missing `partials/nav.php` (main navigation)
   - Missing `partials/footer.php`
   - Missing core pages: `index.php`, `items.php`, `item.php`, `search.php`
   - Missing support pages: `contact.php`, `about.php`, `privacy.php`, `terms.php`
   - Missing admin pages: `admin/index.php`, `admin/users.php`
   - Missing error pages: `errors/404.php`, `errors/500.php`
   - Missing `health.php` (must return 200 without DB dependency)
   - **CORRECT**: Create all mandatory pages as specified in WEBSITE-PAGES-ESSENTIALS rule

2. **Missing Routing Configuration** (-500 points)
   - Missing `.htaccess` file at web root
   - Missing rewrite rules for routing
   - Navigation links that don't resolve to real pages
   - 404 routes not rendering `errors/404.php`
   - **CORRECT**: Include `.htaccess` with RewriteEngine and proper routing, ensure all nav links work, 404 routes to error page

3. **Missing Shared Layout/Partials** (-500 points)
   - Pages not using shared `layout.php`
   - Duplicated `<head>` fragments across pages
   - Navigation not included via `partials/nav.php`
   - Footer not included via `partials/footer.php`
   - **CORRECT**: All pages must use shared layout and partials, no duplicated HTML structure

4. **Incorrect Auth Page Implementation** (-500 points)
   - Including auth pages when lab doesn't require auth (e.g., pure SQL injection on public endpoints)
   - Missing auth pages when lab requires auth (e.g., auth bypass, weak login, session bugs)
   - Registration form with email or extra fields (should only have username and password)
   - Using external services for registration (should be local/temporary)
   - Missing `dashboard.php` or `profile.php` when auth is required
   - **CORRECT**: Include auth pages ONLY when lab scenario requires it, keep registration minimal (username/password only), use local storage

5. **Health Endpoint Database Dependency** (-500 points)
   - `health.php` using database queries
   - Health endpoint failing when database is unavailable
   - Health endpoint not returning 200 quickly
   - **CORRECT**: Health endpoint must return 200 without any database dependency, must be fast and reliable

6. **Database Errors Exposed to Users** (-500 points)
   - Raw database error messages shown to users
   - Fatal exceptions from mysqli queries crashing pages
   - Missing error handling for database queries
   - **CORRECT**: All database errors must be logged server-side (error_log), never shown to users, use safe mysqli patterns

7. **Missing Home Page Content** (-500 points)
   - Home page (`index.php`) is only a lorem-only stub
   - Missing realistic hero/intro section
   - Missing 1–2 content sections
   - Home page doesn't look realistic and clean
   - **CORRECT**: Home page must have realistic content with hero/intro and 1–2 content sections, not just placeholder text

8. **Navigation Link Mismatch** (-500 points)
   - Navigation contains links to pages that don't exist
   - Navigation missing required links (Home, Items, Search, About, Contact)
   - Auth links (Login/Register/Logout/Dashboard) present when auth not needed
   - Auth links missing when auth is required
   - **CORRECT**: Navigation must match page structure, include all required links, show/hide auth links based on lab requirements

### MAJOR VIOLATIONS (-200 points each)

These violations indicate significant rule non-compliance:

1. **Syntax or code quality errors** (-200 points)
   - Leaving syntax errors in code
   - Not fixing linting errors
   - Ignoring type errors
   - Missing required imports

2. **Incomplete task execution** (-200 points)
   - Not addressing all parts of user request
   - Leaving TODO comments without resolution
   - Skipping required steps in workflows
   - Not completing iterative fixes

3. **Ignoring context or scenario rules** (-200 points)
   - Not following PHILOSOPHY constraints
   - Violating realism requirements
   - Ignoring difficulty calibration
   - Breaking testability requirements

4. **Configuration errors** (-200 points)
   - Wrong ports or environment variables
   - Incorrect Docker compose syntax
   - Database connection failures
   - Missing healthchecks

### MODERATE VIOLATIONS (-100 points each)

These violations indicate moderate rule non-compliance:

1. **Code style violations** (-100 points)
   - Not following language-specific rules
   - Ignoring formatting requirements
   - Missing required comments
   - Poor code organization

2. **Documentation gaps** (-100 points)
   - Missing required documentation
   - Incomplete change logs
   - Not updating review files
   - Missing metadata

3. **Workflow violations** (-100 points)
   - Not following phase requirements
   - Skipping review steps
   - Incorrect output file generation
   - Missing validation reports

### MINOR VIOLATIONS (-50 points each)

These violations indicate minor rule non-compliance:

1. **Output formatting issues** (-50 points)
   - Incorrect file formats
   - Missing required headers
   - Poor error messages
   - Incomplete reports

2. **Timing issues** (-50 points)
   - Not waiting for proper initialization
   - Rushing through steps
   - Missing retry logic
   - Premature completion

## COMPLIANCE VERIFICATION CHECKLIST

Before declaring ANY task complete, you MUST verify:

- [ ] All syntax checks passed (0 errors)
- [ ] All linting checks passed (0 errors)
- [ ] All tests executed and passed
- [ ] All required files created/updated correctly
- [ ] All directory rules followed
- [ ] All workflow phases completed
- [ ] All validation steps executed
- [ ] All documentation updated
- [ ] All configuration correct
- [ ] Zero point deductions incurred

### DOCKER VERIFICATION CHECKLIST

- [ ] Dockerfile syntax valid (no "unknown instruction" errors)
- [ ] No raw `<VirtualHost>` or `<Directory>` tags in RUN commands (properly escaped or using COPY)
- [ ] Docker Compose has NO `version:` key
- [ ] All services with `build:` have `image:` directive with correct naming format (`{slug}_{service-name}`)
- [ ] Image names follow convention: `{slug}_{service-name}` (e.g., `union-injection-basics_web`)
- [ ] Port mappings match (internal:external, e.g., 3207:3207)
- [ ] Services configured to listen on assigned internal ports
- [ ] Healthchecks use correct port numbers
- [ ] `depends_on` includes `condition: service_healthy` where needed
- [ ] Apache/Nginx configured to listen on custom port (not just 80)

### DATABASE VERIFICATION CHECKLIST

- [ ] All database users created BEFORE granting privileges
- [ ] `CREATE USER IF NOT EXISTS` used (or Compose env vars for MySQL 5.6)
- [ ] Database and global privileges separated into different GRANT statements
- [ ] `CREATE ROUTINE` used instead of `CREATE FUNCTION` for database grants
- [ ] Init scripts use numbered prefixes (01-, 02-, 03-) for correct order
- [ ] Database connection tested and working
- [ ] PHP/application uses `DB_PORT` environment variable (defaults to 3207, not 3306)
- [ ] MySQL healthcheck uses correct port (`-P 3207`) with quoted password
- [ ] MySQL 5.6 compatibility checked (no `CREATE USER IF NOT EXISTS` if using 5.6)
- [ ] `DB_NAME` environment variable/default matches database created in SQL init scripts
- [ ] All init scripts include `CREATE DATABASE IF NOT EXISTS <db>;` and `USE <db>;`
- [ ] All tables use `CREATE TABLE IF NOT EXISTS`
- [ ] Seed data uses `INSERT IGNORE` or insert-if-missing patterns
- [ ] All tables referenced in PHP code (FROM/JOIN) have matching `CREATE TABLE` in init SQL
- [ ] No "Table 'X.Y' doesn't exist" errors (verified by checking all PHP queries against init SQL)
- [ ] `mysqli_report(MYSQLI_REPORT_OFF);` is set globally or in DB wrapper
- [ ] All mysqli queries check `$result !== false` before fetching rows
- [ ] Database errors logged server-side (`error_log`) and not shown to users
- [ ] Neutral UI text rendered when database errors occur (no fatal exceptions)

### APACHE VERIFICATION CHECKLIST

- [ ] Apache `Listen` directive includes custom port (not just 80)
- [ ] VirtualHost configured for custom port
- [ ] Apache configuration in Dockerfile properly escaped (no raw tags)
- [ ] `.htaccess` file exists at web root with proper rewrite rules
- [ ] Required Apache modules enabled (`a2enmod rewrite`)
- [ ] `ServerName` configured in Apache
- [ ] Healthcheck can reach Apache on assigned port

### NGINX VERIFICATION CHECKLIST

- [ ] Nginx `listen` directive includes custom port (not just 80)
- [ ] `server` blocks properly configured
- [ ] `location` blocks properly configured with `try_files`
- [ ] Nginx configuration syntax valid (`nginx -t` passes)
- [ ] Security headers configured
- [ ] Healthcheck can reach Nginx on assigned port

### GO VERIFICATION CHECKLIST

- [ ] `go.mod` file exists with correct module path
- [ ] All Go files compile successfully (`go build` passes)
- [ ] `go vet` passes without errors
- [ ] Code is properly formatted (`gofmt` compliant)
- [ ] Package declarations match directory structure
- [ ] All dependencies declared in `go.mod`
- [ ] No undefined variables, functions, or types

### JAVA VERIFICATION CHECKLIST

- [ ] `pom.xml` (Maven) or `build.gradle` (Gradle) exists
- [ ] All Java files compile successfully
- [ ] Package declarations match directory structure
- [ ] All dependencies declared in build configuration
- [ ] No undefined classes, methods, or variables
- [ ] Proper exception handling implemented

### NODEJS VERIFICATION CHECKLIST

- [ ] `package.json` exists and is valid JSON
- [ ] All dependencies declared in `package.json`
- [ ] All `require()` or `import` statements resolve correctly
- [ ] No circular dependencies
- [ ] Express routes have proper error handling (if Express is used)
- [ ] Security middleware configured (if Express is used)

### POSTGRESQL VERIFICATION CHECKLIST

- [ ] Init scripts use numbered prefixes (01-, 02-, 03-)
- [ ] All users created BEFORE granting privileges
- [ ] `IF NOT EXISTS` used in user creation
- [ ] No hardcoded passwords in scripts
- [ ] Proper privilege separation
- [ ] Scripts in correct initialization directory

### REDIS VERIFICATION CHECKLIST

- [ ] Password authentication enabled (`requirepass` configured)
- [ ] Redis bound to specific IP (not 0.0.0.0 without protection)
- [ ] Custom port configured if required
- [ ] Dangerous commands disabled or renamed
- [ ] Persistence configured if needed
- [ ] Healthcheck uses correct port

### UI BLACK TAILWIND VERIFICATION CHECKLIST

- [ ] Tailwind CDN script included in all HTML/PHP pages
- [ ] Tailwind configuration includes only black/white/gray colors
- [ ] `<html class="dark">` present on all pages
- [ ] `<body class="min-h-screen bg-black text-white">` present on all pages
- [ ] No chromatic colors (red, blue, green, etc.) in any styles
- [ ] No `linear-gradient` or `radial-gradient` with colors
- [ ] No inline styles with non-monochrome colors
- [ ] All components use only black/white/gray Tailwind utilities
- [ ] Focus rings use white/gray only (not colors)
- [ ] Hover states use opacity/grayscale (not colors)
- [ ] Links use white text (not colored)
- [ ] Validation passed: no color hex codes except #000000, #FFFFFF, or grayscale
- [ ] Validation passed: regex check for `linear-gradient` returns no matches
- [ ] Background is black (#000000) on all pages
- [ ] Primary text is white (#FFFFFF) on all pages

### WEBSITE-PAGES-ESSENTIALS VERIFICATION CHECKLIST

- [ ] `layout.php` exists with HTML head, Tailwind CDN, and body structure
- [ ] `partials/nav.php` exists with main navigation
- [ ] `partials/footer.php` exists
- [ ] Core pages exist: `index.php`, `items.php`, `item.php`, `search.php`
- [ ] Support pages exist: `contact.php`, `about.php`, `privacy.php`, `terms.php`
- [ ] Admin pages exist: `admin/index.php`, `admin/users.php`
- [ ] Error pages exist: `errors/404.php`, `errors/500.php`
- [ ] `health.php` exists and returns 200 without DB dependency
- [ ] `.htaccess` file exists at web root with rewrite rules
- [ ] All navigation links resolve to real pages (return 200)
- [ ] 404 routes render `errors/404.php`
- [ ] All pages use shared `layout.php` (no duplicated `<head>`)
- [ ] Navigation included via `partials/nav.php` on all pages
- [ ] Footer included via `partials/footer.php` on all pages
- [ ] Auth pages included ONLY when lab requires auth (per-lab dynamic)
- [ ] Registration form minimal (username/password only, no email)
- [ ] Registration uses local/temporary storage (no external services)
- [ ] `dashboard.php` and `profile.php` exist when auth is required
- [ ] Auth pages omitted when lab doesn't require auth
- [ ] Home page (`index.php`) has realistic content (hero/intro + 1–2 sections)
- [ ] Home page is not just lorem-only stub
- [ ] Navigation contains required links: Home, Items, Search, About, Contact
- [ ] Auth links (Login/Register/Logout/Dashboard) shown only when auth required
- [ ] Auth links hidden when auth not needed
- [ ] No raw database error messages shown to users
- [ ] Database errors logged server-side (error_log)
- [ ] Safe mysqli patterns used (no fatal exceptions)
- [ ] Health endpoint returns 200 quickly without database queries
- [ ] SEO files present if applicable: `sitemap.xml`, `robots.txt`

## SELF-AUDIT REQUIREMENT

**BEFORE completing any task, you MUST:**

1. Review every action taken against ALL applicable rules
2. Verify zero violations occurred
3. Confirm all mandatory steps completed
4. Check that all outputs meet requirements
5. Ensure no shortcuts or skipped steps
6. Validate that point score remains at 1000

## POINT LOSS CONSEQUENCES

**If you lose ANY points:**
- The task is **NOT complete**
- You **MUST** identify the violation
- You **MUST** fix the violation immediately
- You **MUST** re-verify compliance
- You **MUST** continue until points are restored to 1000

## SUCCESS CRITERIA

**Task completion is ONLY valid when:**
- ✅ All user requirements met
- ✅ All rules followed
- ✅ All validations passed
- ✅ All checks completed
- ✅ **Points remain at 1000 (ZERO deductions)**

## ENFORCEMENT MECHANISM

This system is **ALWAYS ACTIVE** and applies to **EVERY action** you take. Every code change, every file operation, every validation step, and every completion decision is evaluated against this points system.

**You are expected to:**
- Self-monitor your compliance continuously
- Catch violations before they occur
- Fix issues immediately when detected
- Never accept point loss as acceptable
- Maintain perfect compliance (1000 points) at all times

## REMINDER

**ZERO POINT LOSS = SUCCESS**
**ANY POINT LOSS = FAILURE**

Your primary objective is not just to complete tasks, but to complete them with **PERFECT COMPLIANCE** and **ZERO POINT DEDUCTIONS**.

## ⚠️ CRITICAL REMINDERS - MOST COMMON ERRORS ⚠️

**These errors occur frequently and MUST be avoided at all costs:**

### DOCKER ERRORS TO NEVER MAKE:
- ❌ **NEVER** use raw `<VirtualHost>` in RUN commands → Use COPY or escape with `\n\`
- ❌ **NEVER** include `version:` in docker-compose.yml → Remove it completely
- ❌ **NEVER** forget `image:` directive → Always use `image: {slug}_{service-name}` format
- ❌ **NEVER** use wrong image naming format → Must be `{slug}_{service-name}` (e.g., `union-injection-basics_web`)
- ❌ **NEVER** mismatch port mappings → Use same internal:external (3207:3207)
- ❌ **NEVER** let Apache only listen on port 80 → Add `Listen` directive and VirtualHost

### DATABASE ERRORS TO NEVER MAKE:
- ❌ **NEVER** grant privileges before creating users → Create users FIRST
- ❌ **NEVER** mix database and global privileges → Separate GRANT statements
- ❌ **NEVER** use `CREATE FUNCTION` on database grants → Use `CREATE ROUTINE`
- ❌ **NEVER** use port 3306 → Always use 3207 (or custom port from env)
- ❌ **NEVER** skip numbered prefixes in init scripts → Use 01-, 02-, 03-
- ❌ **NEVER** mismatch DB_NAME → `DB_NAME` env/default MUST match database created in init SQL
- ❌ **NEVER** skip `CREATE DATABASE IF NOT EXISTS` and `USE <db>` in init scripts → Include in every init sequence
- ❌ **NEVER** create tables without `IF NOT EXISTS` → All tables must use `CREATE TABLE IF NOT EXISTS`
- ❌ **NEVER** seed data without `INSERT IGNORE` → Use `INSERT IGNORE` or insert-if-missing patterns
- ❌ **NEVER** query tables that don't exist → Every table in PHP queries MUST have `CREATE TABLE` in init SQL
- ❌ **NEVER** let "Table 'X.Y' doesn't exist" errors occur → Verify all FROM/JOIN tables exist in init SQL
- ❌ **NEVER** fetch rows without checking `$result !== false` → Always guard mysqli fetches
- ❌ **NEVER** enable mysqli exceptions → Always use `mysqli_report(MYSQLI_REPORT_OFF);`
- ❌ **NEVER** show database errors to users → Log server-side only, render neutral UI text

### APACHE ERRORS TO NEVER MAKE:
- ❌ **NEVER** forget to configure Apache for custom port → Add Listen + VirtualHost
- ❌ **NEVER** put raw config tags in Dockerfile RUN → Escape or use COPY
- ❌ **NEVER** forget `.htaccess` file → Include rewrite rules
- ❌ **NEVER** skip `a2enmod rewrite` → Enable required modules

### NGINX ERRORS TO NEVER MAKE:
- ❌ **NEVER** forget to configure Nginx for custom port → Add listen directive
- ❌ **NEVER** skip `nginx -t` syntax validation → Always test configuration
- ❌ **NEVER** forget `try_files` in location blocks → Include proper fallback
- ❌ **NEVER** skip security headers → Implement proper security

### GO ERRORS TO NEVER MAKE:
- ❌ **NEVER** forget `go.mod` file → Always include with correct module path
- ❌ **NEVER** skip compilation check → Always run `go build`
- ❌ **NEVER** mismatch package names → Package must match directory structure
- ❌ **NEVER** forget dependencies → Declare all in `go.mod`

### JAVA ERRORS TO NEVER MAKE:
- ❌ **NEVER** forget build configuration → Include `pom.xml` or `build.gradle`
- ❌ **NEVER** skip compilation check → Always compile before completion
- ❌ **NEVER** mismatch package structure → Package must match directory
- ❌ **NEVER** forget dependencies → Declare all in build configuration

### NODEJS ERRORS TO NEVER MAKE:
- ❌ **NEVER** forget `package.json` → Always include with valid JSON
- ❌ **NEVER** use undeclared dependencies → All must be in `package.json`
- ❌ **NEVER** skip error handling in Express routes → Always handle errors
- ❌ **NEVER** forget security middleware → Include helmet, cors, etc.

### POSTGRESQL ERRORS TO NEVER MAKE:
- ❌ **NEVER** grant privileges before creating users → Create users FIRST
- ❌ **NEVER** skip numbered prefixes → Use 01-, 02-, 03- for init scripts
- ❌ **NEVER** hardcode passwords → Use environment variables
- ❌ **NEVER** forget `IF NOT EXISTS` → Prevent duplicate errors

### REDIS ERRORS TO NEVER MAKE:
- ❌ **NEVER** skip password authentication → Always set `requirepass`
- ❌ **NEVER** bind to 0.0.0.0 without protection → Bind to specific IP
- ❌ **NEVER** forget to disable dangerous commands → Rename or disable FLUSHDB, etc.
- ❌ **NEVER** forget custom port configuration → Match Docker Compose port

### UI BLACK TAILWIND ERRORS TO NEVER MAKE:
- ❌ **NEVER** forget Tailwind CDN script → Include in all HTML/PHP pages with black/gray config
- ❌ **NEVER** use chromatic colors → ONLY black (#000000), white (#FFFFFF), and grayscale
- ❌ **NEVER** forget `<html class="dark">` → Must be present on all pages
- ❌ **NEVER** forget `<body class="bg-black text-white">` → Must be present on all pages
- ❌ **NEVER** use gradients → No `linear-gradient` or `radial-gradient` with colors
- ❌ **NEVER** use colored inline styles → Only black/white/gray in inline styles
- ❌ **NEVER** use colored Tailwind utilities → Only `bg-black`, `text-white`, `border-gray-*`, etc.
- ❌ **NEVER** skip UI validation → Must check for gradients, chromatic colors, and Tailwind CDN presence

### WEBSITE-PAGES-ESSENTIALS ERRORS TO NEVER MAKE:
- ❌ **NEVER** forget mandatory page structure → Include layout.php, partials/nav.php, partials/footer.php, all core/support/admin/error pages
- ❌ **NEVER** forget `.htaccess` file → Include rewrite rules for routing
- ❌ **NEVER** duplicate HTML structure → Use shared layout.php and partials on all pages
- ❌ **NEVER** include auth pages when not needed → Only include when lab requires auth
- ❌ **NEVER** omit auth pages when needed → Include login.php, register.php, dashboard.php, profile.php when auth required
- ❌ **NEVER** add email to registration → Registration should only have username and password
- ❌ **NEVER** use external services for registration → Use local/temporary storage
- ❌ **NEVER** make health.php depend on database → Must return 200 without DB queries
- ❌ **NEVER** show database errors to users → Log server-side only, use safe mysqli patterns
- ❌ **NEVER** make home page a lorem stub → Include realistic hero/intro and 1–2 content sections
- ❌ **NEVER** create broken navigation links → All nav links must resolve to real pages
- ❌ **NEVER** show auth links when auth not needed → Hide Login/Register/Logout/Dashboard when auth omitted
- ❌ **NEVER** hide auth links when auth needed → Show Login/Register/Logout/Dashboard when auth required

**Each of these errors results in -500 points. You MUST verify all of these before completing any task.**

---

**This enforcement system overrides any default behavior that might lead to rule violations. Compliance is non-negotiable.**
