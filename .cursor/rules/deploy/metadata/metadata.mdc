---
description: Define lab metadata fields and required values for CI/CD export; enforce examples and accepted formats
globs: [".ctf/metadata.json", ".ctf/LIBRARY_PAGE.md", ".ctf/context/SCENARIO.md", ".ctf/context/FLAG.md"]
alwaysApply: true
---

# METADATA

## Purpose
- Standardize lab metadata for deployment and platform consumption.
- Enforce required fields, formats, and provide examples for each part.

## Required Fields

- Project name
  - Description: Short identifier for Git/registry publishing (not a literal value).
  - Example: `cyberlabs-swaggerapi-prototype-pollution`

- slug
  - Description: URL-safe unique identifier for the lab.
  - Value: `swaggerapi-prototype-pollution`
  - Example: `sql-injection-basic`, `swaggerapi-prototype-pollution`

- title
  - Description: Human-readable lab title.
  - Example: `SwaggerApi prototype pollution`

- description
  - Description: Short paragraph describing the lab’s exploit objective.
  - Example: `The primary objective involves exploiting this architectural weakness to circumvent authentication mechanisms and gain unauthorized access to privileged administrative resources. The ultimate goal is to retrieve the manager account credentials through advanced prototype manipulation techniques.`

- category
  - Allowed: `web`
  - Example: `web`

- difficulty
  - Allowed numeric scale: Easy = 1, Medium = 2, Hard = 3
  - Example: `2`

- flag
  - Description: Concrete flag value used for validation (string).
  - Example: `flag{static_flag}`

- flag_format
  - Description: Allowed formats for the flag; one of the following examples:
  - Examples: `(number +3360000000, flag{static_flag}, static, admin password, manager password , example@example.com )`

- points
  - Integer score for the lab.
  - Value: `100`

- question
  - Description: Player-facing challenge question.
  - Example: `What is the password of the account manager?`

## Example JSON (.ctf/metadata.json)

```json
{
  "project_name": "cyberlabs-swaggerapi-prototype-pollution",
  "slug": "swaggerapi-prototype-pollution",
  "title": "SwaggerApi prototype pollution",
  "description": "The primary objective involves exploiting this architectural weakness to circumvent authentication mechanisms and gain unauthorized access to privileged administrative resources. The ultimate goal is to retrieve the manager account credentials through advanced prototype manipulation techniques.",
  "category": "web",
  "difficulty": 2,
  "flag": "flag{static_flag}",
  "flag_format": "(numéro +3360000000, flag{static_flag}, static, admin password, manager password , example@example.com )",
  "points": 100,
  "question": "What is the password of the account manager?"
}
```

## Acceptance Criteria
- All fields above are present in `.ctf/metadata.json` and match allowed formats.
- `slug` is kebab-case and unique per repository.
- `difficulty` is 1, 2, or 3 only.
- `points` is a positive integer.
- `flag` is a real, non-empty value discoverable via the lab exploit path and matches one of the formats declared in `flag_format`.

## Strict Schema (Required — no extra fields)
- `.ctf/metadata.json` MUST contain ONLY these keys:
  - `project_name`, `slug`, `title`, `description`, `category`, `difficulty`, `flag`, `flag_format`, `points`, `question`
- Reject if any of the following keys appear: `id`, `estimated_time`, `services`, `expose_ports`, `flag_type`, `entry_url`, `health_url`, `questions`, any additional unspecified keys.

## Authoring Template (Fill EXACTLY)
Copy, fill, and commit as `.ctf/metadata.json`:

```json
{
  "project_name": "<git-friendly-name>",
  "slug": "<kebab-case-unique-slug>",
  "title": "<human-readable-title>",
  "description": "<one-paragraph-objective>",
  "category": "web",
  "difficulty": <1|2|3>,
  "flag": "<real-flag-extracted-from-lab>",
  "flag_format": "(number +3360000000, flag{static_flag}, static, admin password, manager password , example@example.com )",
  "points": <integer>,
  "question": "<single challenge question>"
}
```

## Validation Failures (Block Merge)
- `flag` is empty or placeholder (e.g., "", "TBD", "to-fill").
- Any disallowed key present (e.g., `id`, `services`, `questions`).
- Missing any required key from the Strict Schema list.
- `slug` not kebab-case.
- `difficulty` not in {1,2,3}.
- `points` not a positive integer.


